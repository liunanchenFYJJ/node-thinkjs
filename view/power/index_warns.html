<div id="container" class="layui-row">
    <blockquote class="layui-elem-quote">
        告警监测,主要监测子站的设备告警信息！
    </blockquote>
    <div class="layui-tab">
        <ul class="layui-tab-title">
            <li class="layui-this">告警信息总览</li>
            <li>故障信息总览</li>
        </ul>
        <div class="layui-tab-content">
            <div class="layui-tab-item layui-show">
                <div class="layui-row">
                    <div class="layui-col-md6">
                        <fieldset class="layui-elem-field">
                            <legend>今日告警事件(0)</legend>
                            <div class="layui-field-box">
                                <table class="layui-table">
                                    <colgroup>
                                        <col width="150">
                                        <col width="200">
                                        <col>
                                    </colgroup>
                                    <thead>
                                        <tr>
                                        <th>时间</th>
                                        <th>告警等级</th>
                                        <th>告警内容</th>
                                        <th>处理状态</th>
                                        <th>操作</th>
                                        </tr> 
                                    </thead>
                                    <tbody>
                                        <tr>
                                        <td>中国电信</td>
                                        <td>中国电信(苏州)分公司</td>
                                        <td>1315</td>                                                
                                        <td><i class="fa fa-dot-circle-o run">在线</i></td>
                                        <td>
                                            <div class="layui-btn-group">
                                                <button class="layui-btn layui-btn-sm">
                                                    <i class="fa fa-line-chart"></i>
                                                </button>
                                            </div>
                                        </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </fieldset>
                    </div>
                    <div class="layui-col-md6">
                        <fieldset class="layui-elem-field">
                            <legend>周告警信息分布图</legend>
                            <div class="layui-field-box">
                                <div id="warn_week_map"></div>
                            </div>
                        </fieldset>
                    </div>
                </div>
                <fieldset class="layui-elem-field">
                    <legend>过滤查询条件</legend>
                    <div class="layui-field-box">
                        <form class="layui-form">
                            <div class="layui-form-item layui-inline">
                                <label class="layui-form-label">告警等级</label>
                                <div class="layui-input-inline">
                                    <select name="alertlevel" lay-filter="alertlevel">
                                        <option value="">请选择</option>                        
                                        <option value="0">全部</option>
                                        <option value="1">严重</option>
                                        <option value="2">普通</option>
                                        <option value="3">一般</option>
                                    </select>
                                </div>
                            </div>
                            <div class="layui-form-item layui-inline">
                                <label class="layui-form-label">处理状态</label>
                                <div class="layui-input-inline">
                                    <select name="handlest" lay-filter="handlest">
                                        <option value="">请选择</option>                        
                                        <option value="0">全部</option>
                                        <option value="1">未处理</option>
                                        <option value="2">已处理</option>
                                    </select>
                                </div>
                            </div>
                            <div class="layui-form-item layui-inline">
                                <label class="layui-form-label">日期范围</label>
                                <div class="layui-input-block">
                                    <input type="text" name="timerange" class="layui-input" id="test6" placeholder="时间范围">                                   
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <div class="layui-input-block">
                                <button class="layui-btn" lay-submit lay-filter="*">查询</button>
                                <button type="reset" class="layui-btn layui-btn-primary">重置</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </fieldset>
                <fieldset class="layui-elem-field">
                    <legend>告警详细信息(0)</legend>
                    <div class="layui-field-box">
                        <div id="warn-history-table" class="tabulator">？插件？</div>
                    </div>
                </fieldset>
            </div>
            <!-- 2 -->
            <div class="layui-tab-item">
                <div class="layui-row">
                    <div class="layui-col-md6">
                        <fieldset class="layui-elem-field">
                            <legend>待处理故障(0)</legend>
                            <div class="layui-field-box">
                                <table class="layui-table">
                                    <colgroup>
                                        <col width="150">
                                        <col width="200">
                                        <col>
                                    </colgroup>
                                    <thead>
                                        <tr>
                                        <th>时间</th>
                                        <th>故障来源</th>
                                        <th>故障等级</th>                                        
                                        <th>故障描述</th>
                                        <th>处理状态</th>
                                        <th>操作</th>
                                        </tr> 
                                    </thead>
                                    <tbody>
                                        <tr>
                                        <td>中国电信</td>
                                        <td>中国电信(苏州)分公司</td>
                                        <td>13：15</td> 
                                        <td><i class="fa fa-dot-circle-o run">在线</i></td>                                                                                       
                                        <td>张三</td>                                                
                                        <td>
                                            <div class="layui-btn-group">
                                                <button class="layui-btn layui-btn-sm">
                                                    <i class="fa fa-line-chart"></i>
                                                </button>
                                            </div>
                                        </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </fieldset>
                    </div>
                    <div class="layui-col-md6">
                        <fieldset class="layui-elem-field">
                            <legend>故障分布图</legend>
                            <div class="layui-field-box">
                                <div id="fault_week_chart" style="height: 220px; width: 400px"></div>
                            </div>
                        </fieldset>
                    </div>
                </div>
                <fieldset class="layui-elem-field">
                    <legend>过滤查询条件</legend>
                    <div class="layui-field-box">
                        <form class="layui-form">
                            <div class="layui-form-item layui-inline">
                                <label class="layui-form-label">告警等级</label>
                                <div class="layui-input-inline">
                                    <select name="alertlevel" lay-filter="alertlevel">
                                        <option value="">请选择</option>                        
                                        <option value="0">全部</option>
                                        <option value="1">严重</option>
                                        <option value="2">普通</option>
                                        <option value="3">一般</option>
                                    </select>
                                </div>
                            </div>
                            <div class="layui-form-item layui-inline">
                                <label class="layui-form-label">处理状态</label>
                                <div class="layui-input-inline">
                                    <select name="handlest" lay-filter="handlest">
                                        <option value="">请选择</option>                        
                                        <option value="0">全部</option>
                                        <option value="1">未处理</option>
                                        <option value="2">已处理</option>
                                    </select>
                                </div>
                            </div>
                            <div class="layui-form-item layui-inline">
                                <label class="layui-form-label">日期范围</label>
                                <div class="layui-input-block">
                                    <input type="text" name="timerange" class="layui-input" id="test7" placeholder="时间范围">                                   
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <div class="layui-input-block">
                                <button class="layui-btn" lay-submit lay-filter="*">查询</button>
                                <button type="reset" class="layui-btn layui-btn-primary">重置</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </fieldset>
                <fieldset class="layui-elem-field">
                    <legend>故障处理跟踪</legend>
                    <div class="layui-field-box">
                        <table class="layui-table">
                            <colgroup>
                                <col width="150">
                                <col width="200">
                                <col>
                            </colgroup>
                            <thead>
                                <tr>
                                <th>故障名称</th>
                                <th>故障来源</th>
                                <th>发生时间</th>                                        
                                <th>处理状态</th>
                                <th>负责人</th>
                                <th>操作</th>
                                </tr> 
                            </thead>
                            <tbody>
                                <tr>
                                <td>中国电信</td>
                                <td>中国电信(苏州)分公司</td>
                                <td>13：15</td> 
                                <td><i class="fa fa-dot-circle-o run">在线</i></td>                                                                                       
                                <td>张三</td>                                                
                                <td>
                                    <div class="layui-btn-group">
                                        <button class="layui-btn layui-btn-sm">
                                            <i class="fa fa-line-chart"></i>
                                        </button>
                                    </div>
                                </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </fieldset>
            </div>
        </div>
    </div>
</div>
<script>
    (function(){
        layui.use(['form', 'laydate'], function(){
            var form = layui.form;
            var laydate = layui.laydate;
            
            laydate.render({
                elem: '#test6'
                ,range: true
            });
            laydate.render({
                elem: '#test7'
                ,range: true
            });
            // // 根据时间改变地图样式
            // form.on('select(city)', function(data) {

            // });
            // // 根据状态选择站点
            // // 状态过滤 与 数据库里面的状态是否一致？
            // form.on('select(status)', function(data) {

            // });
            form.render();

            form.on('submit(*)', function(data){
                console.log(data.field);
                // $.post('/power/map/searchprj', data.field, function(e) {
                //     // console.log(e.data);
                //     if (e.data.length > 0) {
                //         remove();     
                //         let searchlist = e.data;
                //         var point = new BMap.Point(searchlist[0].prjLon, searchlist[0].prjLat);
                //         map.centerAndZoom(point, 11);    //移动地图中心点                          
                //         addMarker(point, searchlist[0]);    // 
                //         var marker = new BMap.Marker(point);  // 创建标注
                //     }
                // });
                return false; //阻止表单跳转。如果需要表单跳转，去掉这段即可。
            });
            

            // echarts
            var myChart = echarts.init(document.getElementById('warn_week_map')); 
            var myChart1 = echarts.init(document.getElementById('fault_week_chart'));                       

            // 周报警图
            var hours = ['12a', '1a', '2a', '3a', '4a', '5a', '6a',
                    '7a', '8a', '9a','10a','11a',
                    '12p', '1p', '2p', '3p', '4p', '5p',
                    '6p', '7p', '8p', '9p', '10p', '11p'];
            var days = ['Saturday', 'Friday', 'Thursday',
                    'Wednesday', 'Tuesday', 'Monday', 'Sunday'];

            var data = [[0,0,5],[0,1,1],[0,2,0],[0,3,0],[0,4,0],[0,5,0],[0,6,0],[0,7,0],[0,8,0],[0,9,0],[0,10,0],[0,11,2],[0,12,4],[0,13,1],[0,14,1],[0,15,3],[0,16,4],[0,17,6],[0,18,4],[0,19,4],[0,20,3],[0,21,3],[0,22,2],[0,23,5],[1,0,7],[1,1,0],[1,2,0],[1,3,0],[1,4,0],[1,5,0],[1,6,0],[1,7,0],[1,8,0],[1,9,0],[1,10,5],[1,11,2],[1,12,2],[1,13,6],[1,14,9],[1,15,11],[1,16,6],[1,17,7],[1,18,8],[1,19,12],[1,20,5],[1,21,5],[1,22,7],[1,23,2],[2,0,1],[2,1,1],[2,2,0],[2,3,0],[2,4,0],[2,5,0],[2,6,0],[2,7,0],[2,8,0],[2,9,0],[2,10,3],[2,11,2],[2,12,1],[2,13,9],[2,14,8],[2,15,10],[2,16,6],[2,17,5],[2,18,5],[2,19,5],[2,20,7],[2,21,4],[2,22,2],[2,23,4],[3,0,7],[3,1,3],[3,2,0],[3,3,0],[3,4,0],[3,5,0],[3,6,0],[3,7,0],[3,8,1],[3,9,0],[3,10,5],[3,11,4],[3,12,7],[3,13,14],[3,14,13],[3,15,12],[3,16,9],[3,17,5],[3,18,5],[3,19,10],[3,20,6],[3,21,4],[3,22,4],[3,23,1],[4,0,1],[4,1,3],[4,2,0],[4,3,0],[4,4,0],[4,5,1],[4,6,0],[4,7,0],[4,8,0],[4,9,2],[4,10,4],[4,11,4],[4,12,2],[4,13,4],[4,14,4],[4,15,14],[4,16,12],[4,17,1],[4,18,8],[4,19,5],[4,20,3],[4,21,7],[4,22,3],[4,23,0],[5,0,2],[5,1,1],[5,2,0],[5,3,3],[5,4,0],[5,5,0],[5,6,0],[5,7,0],[5,8,2],[5,9,0],[5,10,4],[5,11,1],[5,12,5],[5,13,10],[5,14,5],[5,15,7],[5,16,11],[5,17,6],[5,18,0],[5,19,5],[5,20,3],[5,21,4],[5,22,2],[5,23,0],[6,0,1],[6,1,0],[6,2,0],[6,3,0],[6,4,0],[6,5,0],[6,6,0],[6,7,0],[6,8,0],[6,9,0],[6,10,1],[6,11,0],[6,12,2],[6,13,1],[6,14,3],[6,15,4],[6,16,0],[6,17,0],[6,18,0],[6,19,0],[6,20,1],[6,21,2],[6,22,2],[6,23,6]];

            data = data.map(function (item) {
                return [item[1], item[0], item[2] || '-'];
            });

            option = {
                tooltip: {
                    position: 'top'
                },
                animation: false,
                grid: {
                    height: '50%',
                    y: '10%'
                },
                xAxis: {
                    type: 'category',
                    data: hours
                },
                yAxis: {
                    type: 'category',
                    data: days
                },
                visualMap: {
                    min: 1,
                    max: 10,
                    calculable: true,
                    orient: 'horizontal',
                    left: 'center',
                    bottom: '15%'
                },
                series: [{
                    name: 'Punch Card',
                    type: 'heatmap',
                    data: data,
                    label: {
                        normal: {
                            show: true
                        }
                    },
                    itemStyle: {
                        emphasis: {
                            shadowBlur: 10,
                            shadowColor: 'rgba(0, 0, 0, 0.5)'
                        }
                    }
                }]
            };


            option1 = {
                tooltip : {
                    trigger: 'item',
                    formatter: "{a} <br/>{b} : {c} ({d}%)"
                },
                calculable : true,
                series : [
                    {
                        name:'负荷',
                        type:'pie',
                        radius : [30, 110],
                        center : ['50%', '50%'],
                        roseType : 'area',
                        data:[
                            {value:10, name:'rose1'},
                            {value:5, name:'rose2'},
                            {value:15, name:'rose3'},
                            {value:25, name:'rose4'},
                            {value:25, name:'rose5'},
                        ]
                    }
                ]
            };
            myChart.setOption(option);
            myChart1.setOption(option1);
        });
    }())
</script>
<style>
    #warn_week_map {
        height: 220px;
        width: 100%
    }
</style>